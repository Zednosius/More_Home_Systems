#Added Zed
namespace = mhs

event = {
    id = mhs.1
    hide_window = yes
    is_triggered_only = yes

    immediate = {
		IF = {
			limit = {
				any_country = {
					is_country_type = default
					capital_scope = {
						solar_system = {
							has_star_flag = ikor_system
						}
					}
				}
			}
			random_country = {
				limit = {
					is_country_type = default
					capital_scope = {
						solar_system = {
							has_star_flag = ikor_system
						}
					}
				}
				save_event_target_as = mhs_ikor_owner
			}
			every_country = {
				limit = {
					NOT = {
						is_country_type = default
					}
					capital_scope = {
						solar_system = {
							has_star_flag = ikor_system
						}
					}
				}
				establish_communications = event_target:mhs_ikor_owner
			}
		}

        every_planet = {
            limit = {
                has_planet_flag = not_ideal_planet
            }
            # Go to the system scope and get the space owner
            # Since the planet is not directly owned we can't use owner = {}
            solar_system = {
                space_owner = {
                    save_event_target_as = target_country
                }
            }
            #Run the scripted effect
            #change_planet_to_not_preferred = yes
            planet_event = { id = mhs.2 }
        }
    }
}

planet_event = {
    id = mhs.2
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        change_planet_to_not_preferred = yes
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
		random_list = {
			35 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_dangerous_wildlife"
				}
			}
			30 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_mountain_range"
				}
			}
			25 = {
				random_tile = {
					limit = { has_blocker = no has_building = no }
					set_blocker = "tb_active_volcano"
				}
			}
			10 = {}
		}
    }
}

event = {
    id = mhs.3
    hide_window = yes
    is_triggered_only = yes

    immediate = {

        random_planet = {
            limit = {
                has_planet_flag = mhs_reiir
            }
			planet_event = { id = mhs.4 }
        }
    }
}

planet_event = {
    id = mhs.4
    hide_window = yes
    is_triggered_only = yes

    immediate = {
		change_pc = pc_ringworld_habitable
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"		
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"			
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"		
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_decrepit_dwellings"				
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_decrepit_dwellings"				
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}	
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}	
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_decrepit_dwellings"				
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_failing_infrastructure"
		}
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_decrepit_dwellings"
		}			
		random_tile = {
			limit = { has_blocker = no has_building = no has_pop = no }
			set_blocker = "tb_decrepit_dwellings"		
		}
	}
}

country_event = {
    id = mhs.5
    hide_window = yes
    is_triggered_only = yes

    immediate = {
		random_planet = {
			limit = {
				has_planet_flag = mhs_hades
			}
			random_tile = {
				limit = {
					has_building = building_machine_capital_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_energy_deposit
			}
			random_tile = {
				limit = {
					has_building = building_hydroponics_farm_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_farmland_deposit
			}
			random_tile = {
				limit = {
					has_building = building_hydroponics_farm_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_farmland_deposit
			}
			random_tile = {
				limit = {
					has_building = building_power_plant_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_energy_deposit
			}
			random_tile = {
				limit = {
					has_building = building_mining_network_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_mineral_deposit
			}
			random_tile = {
				limit = {
					has_building = building_basic_science_lab_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				random_list = {
					33 = {
						add_deposit = d_engineering_deposit										
					}
					33 = { 
						add_deposit = d_society_deposit											
					}
					33 = { 
						add_deposit = d_physics_deposit											
					}					
				}	
			}
			random_tile = {
				limit = {
					has_building = building_mining_network_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_mineral_deposit
			}
			random_tile = {
				limit = {
					has_building = building_power_plant_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_energy_deposit
			}
			random_tile = {
				limit = {
					has_building = building_power_plant_1
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_energy_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_failing_infrastructure
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_engineering_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_failing_infrastructure
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_society_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_failing_infrastructure
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_physics_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_decrepit_dwellings
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_energy_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_decrepit_dwellings
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_farmland_deposit
			}
			random_tile = {
				limit = {
					has_blocker = tb_decrepit_dwellings
					has_resource = {
						type = minerals
						amount = 0
					}
					has_resource = {
						type = food
						amount = 0
					}
					has_resource = {
						type = energy
						amount = 0
					}
					has_resource = {
						type = society_research
						amount = 0
					}
					has_resource = {
						type = physics_research
						amount = 0
					}
					has_resource = {
						type = engineering_research
						amount = 0
					}
				}
				add_deposit = d_rich_mineral_deposit
			}
			while = {
				count = 7
				random_tile = {
					limit = {
						has_resource = {
							type = minerals
							amount = 0
						}
						has_resource = {
							type = food
							amount = 0
						}
						has_resource = {
							type = energy
							amount = 0
						}
						has_resource = {
							type = society_research
							amount = 0
						}
						has_resource = {
							type = physics_research
							amount = 0
						}
						has_resource = {
							type = engineering_research
							amount = 0
						}
					}
					random_list = {
						1 = { add_deposit = d_rich_energy_deposit }
						2 = { add_deposit = d_energy_deposit }
						1 = { add_deposit = d_rich_farmland_deposit }
						1 = { add_deposit = d_farmland_deposit }
						1 = { add_deposit = d_rich_mineral_deposit }
						2 = { add_deposit = d_mineral_deposit }
						1 = { add_deposit = d_society_deposit }
						1 = { add_deposit = d_physics_deposit }
						1 = { add_deposit = d_engineering_deposit }
						4 = {}
					}
				}
			}
		}
	}
}